/*!
 * OpenTok JavaScript Library v0.91.51
 * http://www.tokbox.com/
 *
 * Copyright (c) 2011 TokBox, Inc.
 *
 * Date: April 05 14:51:10 2012
 */

function getHostname(){return window.location.hostname}TB=function(){function aj(){this._listeners={};this.addEventListener=function(aE,aF){if(!aE){throw new Error("EventDispatcher.addEventListener :: No type specified")}if(!aF){throw new Error("EventDispatcher.addEventListener :: No listener function specified")}if(!this._listeners.hasOwnProperty(aE)){this._listeners[aE]=new Array()}this.removeEventListener(aE,aF);m("TB.addEventListener("+aE+")");this._listeners[aE].push(aF)};this.removeEventListener=function(aF,aG){if(!aF){throw new Error("EventDispatcher.removeEventListener :: No type specified")}if(!aG){throw new Error("EventDispatcher.removeEventListener :: No listener function specified")}m("TB.removeEventListener("+aF+")");if(this._listeners.hasOwnProperty(aF)){for(var aE=0;aE<this._listeners[aF].length;aE++){if(this._listeners[aF][aE]==aG){this._listeners[aF].splice(aE,1);break}}}};this.dispatchEvent=function(aH){if(!aH){throw new Error("EventDispatcher.dispatchEvent :: No event specified")}if(!aH.type){throw new Error("EventDispatcher.dispatchEvent :: Event has no type")}if(!aH.target){aH.target=this}if(this._listeners.hasOwnProperty(aH.type)){var aG=this._listeners[aH.type];if(aG instanceof Array){for(var aE=0;aE<aG.length;aE++){var aF=ad(aG[aE],aH);setTimeout(aF,1)}}else{throw new Error("EventDispatcher.dispatchEvent :: Invalid object type in listeners")}}}}function I(aG,aE){this.type=aG;this.cancelable=aE?aE:false;this.target;var aF=false;this.preventDefault=function(){if(this.cancelable){aF=true}else{aD("Event.preventDefault :: Trying to preventDefault on an Event that isn't cancelable")}};this.isDefaultPrevented=function(){return aF}}function z(aE,aG,aH,aF){this.superClass=I;this.superClass(aE);this.message=aG;this.title=aH;this.code=aF}function an(aF,aE,aG){this.superClass=I;this.superClass(aF);this.connections=aE;this.reason=aG}function ap(aF,aH,aG,aE){this.superClass=I;this.superClass(aF,aE);this.streams=aH;this.reason=aG}function aA(aG,aF,aH,aE){this.superClass=I;this.superClass(aG);this.connections=aF;this.streams=aH;this.archives=aE;this.groups=[]}function p(aF,aG,aE){this.superClass=I;this.superClass(aF,aE);this.reason=aG}function at(aE,aF){this.superClass=I;this.superClass(aE);this.fromConnection=aF}function X(aE,aG,aF){this.superClass=I;this.superClass(aE);this.streamId=aG;this.volume=aF}function d(aF,aE,aG){this.superClass=I;this.superClass(aF);this.camera=aE;this.microphone=aG}function V(aH,aE,aG,aF,aI){this.superClass=I;this.superClass(aH);this.cameras=aE;this.microphones=aG;this.selectedCamera=aF;this.selectedMicrophone=aI}function h(aF,aG,aE,aI,aH){this.superClass=I;this.superClass(aF);this.widthFrom=aG;this.widthTo=aE;this.heightFrom=aI;this.heightTo=aH}function K(aF,aH,aI,aE,aG){this.superClass=I;this.superClass(aF);this.type=aF;this.stream=aH;this.changedProperty=aI;this.oldValue=aE;this.newValue=aG}function am(aF,aE){this.superClass=I;this.superClass(aF);this.archives=aE}function a(aF,aE,aG){this.superClass=I;this.superClass(aF);this.archive=aE;this.streams=aG}function U(aE,aF){this.superClass=I;this.superClass(aE);this.changedValues=aF}function Z(aE,aH,aF,aG){this.superClass=I;this.superClass(aE);this.reasonCode=aH;this.reason=aF;this.failedValues=aG}function E(aG,aE,aF){this.connectionId=aG;this.creationTime=Number(aE);this.data=aF;this.quality}function O(aE,aH,aF,aL,aO,aM,aN,aJ,aG,aK,aI,aP){this.streamId=aE;this.connection=aH;this.name=aF;this.data=aL;this.type=aO;this.creationTime=aM;this.hasAudio=aN;this.hasVideo=aJ;this.orientation=aG;this.peerId=aI;this.quality=aP;this.startRecording=function(aR){m("Stream.startRecording()");var aU="controller_"+aK;aR=v[aK][aR.archiveId];if(!aR){var aT="Stream.startRecording :: Archive not created.";al(aT);throw new Error(aT)}if(aR.type!=TB.PER_STREAM){aT="Stream.startRecording :: Trying to record per stream on a "+aR.type+" archive";al(aT);throw new Error(aT)}if(aU&&this.connection&&this.connection.connectionId){try{var aQ=document.getElementById(aU);aQ.startRecordingStream(this.streamId,aR.archiveId);aR.recording=true}catch(aS){aT="Stream.startRecording :: "+aS;al(aT);throw new Error(aT)}}else{aT="Stream.startRecording :: Connection required to record an archive.";al(aT);throw new Error(aT)}};this.stopRecording=function(aR){m("Stream.stopRecording()");aR=v[aK][aR.archiveId];if(!aR){var aT="Stream.stopRecording :: Archive not created.";al(aT);throw new Error(aT)}if(aR.type!=TB.PER_STREAM){aT="Stream.stopRecording :: Trying to stop recording per stream on a "+aR.type+" archive";al(aT);throw new Error(aT)}var aU="controller_"+aK;if(aU&&this.connection&&this.connection.connectionId){try{var aQ=document.getElementById(aU);aQ.stopRecordingStream(this.streamId,aR.archiveId)}catch(aS){aT="Stream.stopRecording :: "+aS;al(aT);throw new Error(aT)}}else{aT="Stream.stopRecording :: Connection required to record an archive.";al(aT);throw new Error(aT)}}}function ag(aF,aE){this.id=aF;this.replacedDivId=aE;this.parentClass=aj;this.parentClass()}function S(aH,aF){this.uberClass=ag;this.uberClass(aH,aF);var aE=["showMicButton","showSpeakerButton","showSettingsButton","showCameraToggleButton","nameDisplayMode","buttonDisplayMode","showSaveButton","showRecordButton","showRecordStopButton","showReRecordButton","showPauseButton","showPlayButton","showPlayStopButton","showStopButton","backgroundImageURI","showControlPanel","showRecordCounter","showPlayCounter","showControlBar","showPreviewTime"];this.getStyle=function(aK){var aI=document.getElementById(this.id);if(!this.loaded){if(aK){return this._style[aK]}else{return this._style}}else{if(aI){try{var aL=aI.getStyle(aK);if(typeof(aL)=="string"){return aL}for(var aJ in aL){if(aL[aJ]=="false"){aL[aJ]=false}if(aL[aJ]=="true"){aL[aJ]=true}if(aE.indexOf(aJ)<0){delete aL[aJ]}}return aL}catch(aN){var aM="Publisher.getStyle:: Failed to call getStyle. "+aN;al(aM);throw new Error(aM)}}else{aM="Publisher.getStyle:: Publisher "+this.id+" does not exist.";al(aM);throw new Error(aM)}}};this._style={};var aG={buttonDisplayMode:["auto","off","on"],nameDisplayMode:["auto","off","on"],showSettingsButton:[true,false],showMicButton:[true,false],showCameraToggleButton:[true,false],showSaveButton:[true,false],backgroundImageURI:null,showControlBar:[true,false],showPlayCounter:[true,false],showRecordCounter:[true,false],showPreviewTime:[true,false]};this.setStyle=function(aK,aN){m("Publisher.setStyle: "+aK.toString());var aI=document.getElementById(this.id);if(!this.loaded){if((typeof(aK)=="string")&&aN!=null){if(this._style.hasOwnProperty(aK)&&(aK=="backgroundImageURI"||(aG[aK].indexOf(aN)>-1))){m("setStyle::Setting "+aK+" to "+aN);this._style[aK]=aN}else{aD("setStyle::Invalid style property passed "+aK+" : "+aN)}}else{for(var aJ in aK){this.setStyle(aJ,aK[aJ])}}this.modified=true}else{if(aI){try{aI.setStyle(aK,aN)}catch(aM){var aL="Publisher.setStyle:: Failed to call setStyle. "+aM;al(aL);throw new Error(aL)}}else{aL="Publisher.setStyle:: Publisher "+this.id+" does not exist.";al(aL);throw new Error(aL)}}return this}}function o(aF,aE){this.supClass=S;this.supClass(aF,aE);this.getImgData=function(){m("VideoComponent.getImgData");var aG=document.getElementById(this.id);if(aG){try{return aG.getImgData()}catch(aI){var aH="VideoComponent.getImgData:: Failed to call getImgData. "+aI;al(aH);throw new Error(aH)}}else{aH="VideoComponent.getImgData:: Component "+this.id+" does not exist.";al(aH);throw new Error(aH)}}}function G(aG,aF,aE){this.superClass=o;this.superClass(aG,aF);this._style={showMicButton:true,showSettingsButton:true,showCameraToggleButton:true,nameDisplayMode:"auto",buttonDisplayMode:"auto",backgroundImageURI:null};this.modified=false;if(aE&&aE.hasOwnProperty("style")){this.setStyle(aE.style);this.modified=true}this.properties=aE;this.loaded=false;this.panelId=null;this.gain=50;if(aE&&aE.hasOwnProperty("microphoneGain")){this.gain=parseInt(aE.microphoneGain,10)}this.enableMicrophone=function(){this.publishAudio(true)};this.disableMicrophone=function(){this.publishAudio(false)};this.setMicrophoneGain=function(aK){var aH=document.getElementById(this.id);if(!this.loaded){this.gain=aK;this.modified=true}else{if(aH){try{aH.setMicGain(aK)}catch(aJ){var aI="Microphone gain adjustment on publisher "+this.id+" failed";al(aI);throw new Error(aI)}}else{aI="Publisher "+this.id+" does not exist.";al(aI);throw new Error(aI)}}return this};this.getMicrophoneGain=function(){var aH=document.getElementById(this.id);if(!this.loaded){return this.gain}else{if(aH){try{return aH.getMicGain()}catch(aJ){var aI="Microphone gain adjustment on publisher "+this.id+" failed";al(aI);throw new Error(aI)}}else{aI="Publisher "+this.id+" does not exist.";al(aI);throw new Error(aI)}}};this.getEchoCancellationMode=function(){m("Publisher.getEchoCancellationMode()");var aK="";var aH=document.getElementById(this.id);if(!this.loaded){return"unknown"}else{if(aH){try{aK=aH.getEchoCancellationMode()}catch(aJ){var aI="Getting echo cancellation mode for publisher "+this.id+" failed. "+aJ;al(aI);throw new Error(aI)}}else{aI="Publisher "+this.id+" does not exist.";al(aI);throw new Error(aI)}}return aK};this.publishAudio=function(aH){m("Publisher.publishAudio()");if(!this.loaded){this.audioPublished=aH;this.modified=true}else{g(this.id,"publishAudio",aH)}};this.publishVideo=function(aH){m("Publisher.publishVideo()");if(!this.loaded){this.videoPublished=aH;this.modified=true}else{g(this.id,"publishVideo",aH)}};this.setCamera=function(aH){m("Publisher.setCamera("+aH+")");f(this.id,aH,true)};this.setMicrophone=function(aH){m("Publisher.setMicrophone("+aH+")");f(this.id,aH,false)}}function R(aI,aJ,aH,aF){this.superClass=o;this.superClass(aJ,aH);this._style={nameDisplayMode:"auto",buttonDisplayMode:"auto",backgroundImageURI:null};this.modified=false;if(aF&&aF.hasOwnProperty("style")){this.setStyle(aF.style);this.modified=true}this.stream=aI;this.properties=aF;this.loaded=false;this.audioVolume=50;var aE=true;var aG=true;if(aF){if(aF.hasOwnProperty("subscribeToAudio")&&(aF.subscribeToAudio=="false"||aF.subscribeToAudio==false)){aE=false}if(aF.hasOwnProperty("subscribeToVideo")&&(aF.subscribeToVideo=="false"||aF.subscribeToVideo==false)){aG=false}if(aF.hasOwnProperty("audioVolume")){this.audioVolume=parseInt(aF.audioVolume,10)}}this.enableAudio=function(){this.subscribeToAudio(true)};this.disableAudio=function(){this.subscribeToAudio(false)};this.setAudioVolume=function(aN){var aK=document.getElementById(this.id);if(!this.loaded){this.audioVolume=aN}else{if(aK){try{aK.setAudioVolume(aN)}catch(aM){var aL="Volume adjustment on subscriber "+this.id+" failed";al(aL);throw new Error(aL)}}else{aL="Subscriber "+this.id+" does not exist.";al(aL);throw new Error(aL)}}return this};this.getAudioVolume=function(){var aK=document.getElementById(this.id);if(!this.loaded){return this.audioVolume}if(aK){try{return aK.getAudioVolume()}catch(aM){var aL="Volume adjustment on subscriber "+this.id+" failed";al(aL);throw new Error(aL)}}else{aL="Subscriber "+this.id+" does not exist.";al(aL);throw new Error(aL)}return this};this._subscribeToAudio=function(aK,aL){m("Subscriber.subscribeToAudio()");if(!aL||aE){if(!this.loaded){this.audioSubscribed=aK;this.modified=true}else{g(this.id,"subscribeToAudio",aK)}}};this.subscribeToAudio=function(aK){aE=aK;this._subscribeToAudio(aE,false)};this._subscribeToVideo=function(aK,aL){m("Subscriber.subscribeToVideo()");if(!aL||aG){if(!this.loaded){this.videoSubscribed=aK;this.modified=true}else{g(this.id,"subscribeToVideo",aK)}}};this.subscribeToVideo=function(aK){aG=aK;this._subscribeToVideo(aG,false)};this.changeOrientation=function(aK){m("Subscriber.changeOrientation()");g(this.id,"changeOrientation",aK)}}function ab(aH,aG,aE,aF){this.superClass=ag;this.superClass(aH,aG);if(aE){this.publisher=aE;this.component=aE}else{this.publisher=null;this.component=aE}this.parentCreated=false;this.properties=aF}function az(aF,aE){this.name=aF;this.status=aE}function aw(aF,aE){this.name=aF;this.status=aE}function s(aG,aF,aJ,aI,aE){this.archiveId=aG;this.type=aF;this.title=aJ;this.sessionId=aI;var aH;if(aE=="sessionRecordingInProgress"){this.recording=true;this.status="open"}else{this.recording=false;this.status=aE}this.startPlayback=function(aL){if(!aL){aL=false}m("Archive.startPlayback() : "+aL);var aP="controller_"+aI;var aM=TB.sessions[aI].connection;if(!W[aI][this.archiveId]){var aO="Archive.startPlayback :: Archive not loaded.";al(aO);throw new Error(aO)}if(aP&&aM&&aM.connectionId){try{var aK=document.getElementById(aP);aK.startPlayback(this.archiveId,aL)}catch(aN){aO="Archive.startPlayback :: "+aN;al(aO);throw new Error(aO)}}else{aO="Archive.startPlayback :: Connection required to play back an archive.";al(aO);throw new Error(aO)}};this.stopPlayback=function(){m("Archive.stopPlayback()");var aO="controller_"+aI;var aL=TB.sessions[aI].connection;if(aO&&aL&&aL.connectionId){try{var aK=document.getElementById(aO);aK.stopPlayback(this.archiveId)}catch(aN){var aM="Archive.stopPlayback :: "+aN;al(aM);throw new Error(aM)}}else{aM="Archive.stopPlayback :: Connection required to stop playing back an archive.";al(aM);throw new Error(aM)}};this.getStateManager=function(){m("Archive.getStateManager() "+aG);if(aH){return aH}else{var aM="controller_"+aI;var aK=TB.sessions[aI].connection;if(aM&&aK&&aK.connectionId){aH=new F(aM,aG);return aH}}var aL="Archive.getStateManager :: Connection required to getStateManager. Make sure that this archive was loaded in a Session.";al(aL);throw new Error(aL)}}function Y(aG,aF,aE){this.superClass=o;this.superClass(aG,aF);this._style={buttonDisplayMode:"auto",showCameraToggleButton:true,showControlBar:true,showMicButton:true,showPlayCounter:true,showRecordCounter:true,showSaveButton:true,showSettingsButton:true};this.id=aG;this.properties=aE;this.saveArchive=function(){var aH=document.getElementById(this.id);aH.save()};this.setCamera=function(aH){m("Recorder.setCamera("+aH+")");f(this.id,aH,true)};this.setMicrophone=function(aH){m("Recorder.setMicrophone("+aH+")");f(this.id,aH,false)};this.stopRecording=function(){recorderElement=document.getElementById(this.id);recorderElement.stopRecording()};this.startRecording=function(aH){recorderElement=document.getElementById(this.id);recorderElement.startRecording(aH)};this.startPlaying=function(){m("Recorder.startPlaying()");try{var aH=document.getElementById(this.id);aH.startPlaying()}catch(aJ){var aI="Recorder.startPlaying :: "+aJ;al(aI);throw new Error(aI)}};this.stopPlaying=function(){m("Recorder.stopPlaying()");try{var aH=document.getElementById(this.id);aH.stopPlaying()}catch(aJ){var aI="Recorder.stopPlaying :: "+aJ;al(aI);throw new Error(aI)}};this.setTitle=function(aK){var aH=document.getElementById(this.id);if(!this.loaded){this._title=aK;this.modified=true}else{if(aH){try{aH.setTitle(aK)}catch(aJ){var aI="Setting archive title on Recorder "+this.id+" failed.";al(aI);throw new Error(aI)}}else{aI="Recorder "+this.id+" does not exist.";al(aI);throw new Error(aI)}}}}function aq(aG,aF,aE){this.superClass=o;this.superClass(aG,aF);this._style={showPlayButton:true,showStopButton:true,showSpeakerButton:true,showPreviewTime:true};this.id=aG;this.properties=aE;this.archiveId;this.loadArchive=function(aK){if(aK){if(this.loaded){try{var aH=document.getElementById(this.id);aH.loadArchive(aK);this.archiveId=aK}catch(aJ){var aI="Player.loadArchive :: "+aJ;al(aI);throw new Error(aI)}}else{this._archiveId=aK}}else{aI="Player.loadArchive :: Archive id required to load an archive.";al(aI);throw new Error(aI)}};this.play=function(){if(this.loaded){try{var aH=document.getElementById(this.id);aH.startPlayback()}catch(aJ){var aI="Player.play :: "+aJ;al(aI);throw new Error(aI)}}else{this._play=true}};this.stop=function(){if(this.loaded){try{var aH=document.getElementById(this.id);aH.stopPlayback()}catch(aJ){var aI="Player.stop :: "+aJ;al(aI);throw new Error(aI)}}else{this._play=false}};this.pause=function(){if(this.loaded){try{var aH=document.getElementById(this.id);aH.pausePlayback()}catch(aJ){var aI="Player.pause :: "+aJ;al(aI);throw new Error(aI)}}else{this._play=false}}}function ax(aI){this.superClass=aj;this.superClass();this.apiKey=aI;this.panels={};this.showMicSettings=true;this.showCamSettings=true;var aF=360;var aH=270;var aE=340;var aG=230;this.detectDevices=function(){m("DeviceManager.detectDevices()");if(!aC){var aN={};aN.allowscriptaccess="always";aC="opentok_deviceDetector";var aJ={};aJ.id=aC;var aK={};swfobject.addDomLoadEvent(function(){var aO=document.createElement("div");aO.setAttribute("id",aC);aO.style.display="none";document.body.appendChild(aO);swfobject.embedSWF(u+"/v0.91.51.6094344/flash/f_devicedetectorwidget.swf?partnerId="+aI,aC,1,1,"10.0.0",false,aK,aN,aJ)})}else{try{var aL=document.getElementById(aC);aL.detectDevices()}catch(aM){al(aM);throw new Error("DeviceManager.detectDevices() :: Failed to locate existing device detector "+aM)}}};this.displayPanel=function(aM,aR,aN){m("DeviceManager.displayPanel("+aM+")");var a1;if(aR){a1="displayPanel_"+aR.id}else{a1="displayPanel_global"}if(aR&&TB.sessions){for(var aY in TB.sessions){if(TB.sessions[aY].hasOwnProperty("publishers")&&TB.sessions[aY].publishers[aR.id]){TB.sessions[aY].publishers[aR.id].panelId=a1}}}var aW=document.getElementById(a1);if(aW){aD("DeviceManager.displayPanel :: there is already a device panel"+(aR?" for this component":""));return this.panels[a1]}var aQ=false;var aT=(aN)?au(aN):{};var aZ={};aZ.allowscriptaccess="always";var aX=aF;var aV=aH;if("showCloseButton" in aT){if(aT.showCloseButton==false){aX=aE;aV=aG}}else{aT.showCloseButton=true}if(!("showMicSettings" in aT)){aT.showMicSettings=this.showMicSettings}if(!("showCamSettings" in aT)){aT.showCamSettings=this.showCamSettings}if(!aM){aM="devicePanel_replace_div";var aS=document.createElement("div");aS.setAttribute("id",aM);var aL=document.createElement("div");aL.setAttribute("id","devicePanel_parent_"+(aR?aR.id:"global"));aL.style.position="absolute";var aP=("pageYOffset" in window&&typeof(window.pageYOffset)=="number")?window.pageYOffset:(document.body&&document.body.scrollTop)?document.body.scrollTop:(document.documentElement&&document.documentElement.scrollTop)?document.documentElement.scrollTop:0;var aK=("innerHeight" in window)?window.innerHeight:(document.documentElement&&document.documentElement.offsetHeight)?document.documentElement.offsetHeight:aH;aP+=(aK*0.2);aL.style.top=aP+"px";aL.style.left="50%";aL.style.width=aX+"px";aL.style.height=aV+"px";aL.style.marginLeft=(0-aX/2)+"px";aL.style.marginTop=(0-aV/4)+"px";if("zIndex" in aT){aL.style.zIndex=aT.zIndex;delete aT.zIndex}else{aL.style.zIndex=Q()+1}document.body.appendChild(aL);aQ=true;aL.appendChild(aS)}var aU=document.getElementById(aM);if(!aU){var aJ="DeviceManager.displayPanel :: replaceElementId does not exist in DOM.";al(aJ);throw new Error(aJ)}var a0;if(this.panels[a1]){this.removePanel(this.panels[a1])}if(aR){a0=new ab(a1,aM,aR,aT)}else{a0=new ab(a1,aM,null,aT)}a0.parentCreated=aQ;this.panels[a1]=a0;var aO={};aO.id=a0.id;aO.style="outline:none;";aT.devicePanelId=a1;if(aT.wmode){aZ.wmode=aT.wmode;delete aT.wmode}else{aZ.wmode="transparent"}J(u+"/v0.91.51.6094344/flash/f_devicewidget.swf?partnerId="+this.apiKey,aM,aX,aV,q,false,aT,aZ,aO);return a0};this.removePanel=function(aK){if(!aK.hasOwnProperty("id")){var aQ="DeviceManager.removePanel :: invalid DevicePanel object";al(aQ);throw new Error(aQ)}m("DeviceManager.removePanel("+aK.id+")");var aP=document.getElementById(aK.id);if(!aP){aQ="DeviceManager.removePanel :: DevicePanel does not exist in DOM";al(aQ);throw new Error(aQ)}var aS=aP.parentNode;var aR=aK.parentCreated;for(var aM in this.panels){if(this.panels[aM].hasOwnProperty("id")&&aM==aK.id){var aJ=this.panels[aM];l(this.panels[aM]);delete this.panels[aM];var aN=function(){if(aJ.publisher&&TB.sessions){for(var aT in TB.sessions){if(TB.sessions[aT].hasOwnProperty("disconnect")&&TB.sessions[aT].publishers[aJ.publisher.id]){TB.sessions[aT].publishers[aJ.publisher.id].panelId=null}}}};setTimeout(aN,2)}}if(aR){try{var aO=aS.parentNode;aO.removeChild(aS)}catch(aL){aQ="Failed to clean up the parent of the device panel "+aL;al(aQ);throw new Error(aQ)}}}}function av(aJ){var aE=1;var aI=1;this.recorders={};this.players={};this.apiKey=aJ;var aF=320;var aG=271;var aH=31;this.displayRecorder=function(aK,aP,aO){if(!aK){errorMsg="RecorderManager.displayRecorder :: Token required to displayRecorder";al(errorMsg);throw new Error(errorMsg)}var aS="recorder_"+aJ+"_"+aE++;var aN=(aO)?au(aO):{};aN.token=aK;aN.partnerId=aJ;aN.recorderId=aS;if(aN.hasOwnProperty("style")){var aR=aN.style.showControlBar;aN.style=encodeURIComponent(H(aN.style))}var aL={};aL.allowscriptaccess="always";if(aN.wmode){aL.wmode=aN.wmode;delete aN.wmode}else{aL.wmode="transparent"}var aM={};aM.id=aS;aM.style="outline:none;";if(!aN.width||isNaN(aN.width)){aN.width=aF}if(!aN.height||isNaN(aN.height)){aN.height=aG;if(aR==false){aN.height-=aH}}var aQ=false;if(!aP){aP="recorder_replace_"+aE;aQ=true}swfobject.addDomLoadEvent(function(){if(aQ){var aT=document.createElement("div");aT.setAttribute("id",aP);document.body.appendChild(aT)}J(u+"/v0.91.51.6094344/flash/f_recordwidget.swf?partnerId="+aJ,aP,aN.width,aN.height,q,false,aN,aL,aM)});this.recorders[aS]=new Y(aS,aP,aN);return this.recorders[aS]};this.removeRecorder=function(aK){if(!aK){var aL="Session.removeRecorder :: recorder cannot be null";al(aL);throw new Error(aL)}m("Session.removeRecorder("+aK.id+")");l(aK);delete this.recorders[aK.id]};this.displayPlayer=function(aO,aK,aR,aQ){if(!aO){errorMsg="RecorderManager.displayPlayer :: Valid ArchiveId required";al(errorMsg);throw new Error(errorMsg)}var aL="player_"+aJ+"_"+aI++;var aP=(aQ)?au(aQ):{};aP.token=aK;aP.archiveId=aO;aP.partnerId=aJ;aP.playerId=aL;if(aP.hasOwnProperty("style")){var aT=aP.style.showControlBar;aP.style=encodeURIComponent(H(aP.style))}var aM={};aM.allowscriptaccess="always";if(aP.wmode){aM.wmode=aP.wmode;delete aP.wmode}else{aM.wmode="transparent"}var aN={};aN.id=aL;aN.style="outline:none;";if(!aP.width||isNaN(aP.width)){aP.width=aF}if(!aP.height||isNaN(aP.height)){aP.height=aG;if(aT==false){aP.height-=aH}}if(!aP.autoPlay){aP.autoPlay=false}var aS=false;if(!aR){aR="player_replace_"+aI;aS=true}swfobject.addDomLoadEvent(function(){if(aS){var aU=document.createElement("div");aU.setAttribute("id",aR);document.body.appendChild(aU)}J(u+"/v0.91.51.6094344/flash/f_playerwidget.swf?partnerId="+aJ,aR,aP.width,aP.height,q,false,aP,aM,aN)});this.players[aL]=new aq(aL,aR,aP);return this.players[aL]};this.removePlayer=function(aK){if(!aK){var aL="Session.removePlayer :: player cannot be null";al(aL);throw new Error(aL)}m("Session.removePlayer("+aK.id+")");l(aK);delete this.players[aK.id]}}function D(aK){this.superClass=aj;this.superClass();this.sessionId=aK;this.connection;this.subscribers={};this.publishers={};this.apiKey;this.capabilities;this.connected=false;this.connecting=false;var aF=1;var aI=1;var aE=264;var aG=198;var aH;var aJ;this.connect=function(aS,aO,aN){if(this.connecting){aD("Session.connect :: Patience, please.");return}m("Session.connect("+aS+")");if(!TB.checkSystemRequirements()){var aP="Session.connect :: Flash Player Version 10+ required";al(aP);throw new Error(aP)}if(!aS){aP="Session.connect :: API key required to connect";al(aP);throw new Error(aP)}if(!aO){aP="Session.connect :: Token required to connect";al(aP);throw new Error(aP)}if(this.connected){aD("Session.connect :: Session already connected");return}this.connecting=true;var aL=(aN)?au(aN):{};this.apiKey=aS;this.token=aO;this.properties=aN;var aR={};aR.allowscriptaccess="always";if(aL.wmode){aR.wmode=aL.wmode;delete aL.wmode}if(aL.connectionData){aL.connectionData=encodeURIComponent(aL.connectionData)}aH="controller_"+this.sessionId;var aM={};aM.id=aH;aL.sessionId=this.sessionId;aL.token=this.token;var aQ="replace_"+this.sessionId;swfobject.addDomLoadEvent(function(){var aU=document.createElement("div");aU.setAttribute("id",aQ);aU.style.display="none";document.body.appendChild(aU);var aT=new Date();aL.startTime=aT.getTime();swfobject.embedSWF(u+"/v0.91.51.6094344/flash/f_controllerwidget.swf?partnerId="+aS,aQ,1,1,q,false,aL,aR,aM)});if(window.location.protocol=="file:"){setTimeout("TB.controllerLoadCheck()",8000)}};this.disconnect=function(){m("Session.disconnect()");if(!aH||this.connecting){aD("Session.disconnect :: No connection to disconnect");return}var aL=document.getElementById(aH);if(aL){if(!isUnloading){try{aL.cleanupView()}catch(aN){var aM="Session.disconnect :: Failed to disconnect - "+aN;al(aM);throw new Error(aM)}}}else{aD("Session.disconnect :: No connection to disconnect")}};this.disconnectComponents=function(){m("Session.disconnectComponents() - disconnecting publishers and subscribers");for(var aM in this.publishers){if(this.publishers[aM].hasOwnProperty("id")){aa(this.publishers[aM])}}for(var aL in this.subscribers){if(this.subscribers[aL].hasOwnProperty("id")){aa(this.subscribers[aL])}}};this.cleanup=function(){m("Session.cleanup()");for(var aM in this.publishers){if(this.publishers[aM].hasOwnProperty("id")){this.unpublish(this.publishers[aM])}}for(var aL in this.subscribers){if(this.subscribers[aL].hasOwnProperty("id")){this.unsubscribe(this.subscribers[aL])}}};this.cleanupConnection=function(){m("Session.cleanupConnection() - removing controller");this.connection=null;if(!aH){aD("Session.cleanup :: No connection to clean up");return}if(document.getElementById(aH)){setTimeout(function(){ak(aH,"TB.sessionDisconnected :: ");aH=null},0)}else{aD("Session.cleanup :: No connection to clean up")}};this.publish=function(aL,aO){m("Session.publish("+aL+"):"+aO);if(!this.connection||!this.connection.connectionId){var aQ="Session.publish :: Connection required to publish";al(aQ);throw new Error(aQ)}if(!aL){var aR=document.createElement("div");aL="publisher_replace_"+this.sessionId+"_"+aF;aR.setAttribute("id",aL);document.body.appendChild(aR)}var aM=(aO)?au(aO):{};if(aM.name!=undefined&&aM.name.length>1000){aQ="Session.publish :: name property longer than 1000 chars.";al(aQ);throw new Error(aQ)}if(aM.data!=undefined&&aM.data.length>1000){aQ="Session.publish :: data property longer than 1000 chars.";al(aQ);throw new Error(aQ)}var aN="publisher_"+this.sessionId+"_"+aF++;var aP=new G(aN,aL,aM);return this._embedPublisher(aP)};this._embedPublisher=function(aO){var aN=document.getElementById(aO.replacedDivId);if(!aN){errorMsg="Session.publish :: replaceElementId does not exist in DOM.";al(errorMsg);throw new Error(errorMsg)}var aP={};aP.allowscriptaccess="always";aP.cameraSelected=ay;if(aO.properties.wmode){aP.wmode=aO.properties.wmode;delete aO.properties.wmode}else{aP.wmode="transparent"}if(aO.properties.hasOwnProperty("style")){aO.properties.style=encodeURIComponent(H(aO.properties.style))}var aM={};aM.id=aO.id;aM.style="outline:none;";aO.properties.publisherId=aO.id;aO.properties.connectionId=this.connection.connectionId;aO.properties.sessionId=this.sessionId;aO.properties.token=this.token;aO.properties.cameraSelected=ay;aO.properties.simulateMobile=TB.simulateMobile;aO.properties.publishCapability=this.capabilities.publish;if(!aO.properties.width||isNaN(aO.properties.width)){aO.properties.width=aE}if(!aO.properties.height||isNaN(aO.properties.height)){aO.properties.height=aG}this.publishers[aO.id]=aO;var aL=new Date();aO.properties.startTime=aL.getTime();J(u+"/v0.91.51.6094344/flash/f_publishwidget.swf?partnerId="+this.apiKey,aO.replacedDivId,aO.properties.width,aO.properties.height,q,false,aO.properties,aP,aM);return aO};this.unpublish=function(aM){if(!aM){var aL="Session.unpublish :: publisher cannot be null";al(aL);throw new Error(aL)}m("Session.unpublish("+aM.id+")");if(aM.panelId&&n&&n.panels[aM.panelId]){n.removePanel(n.panels[aM.panelId])}l(aM);delete this.publishers[aM.id]};this.forceUnpublish=function(aP){var aO;if(aP&&typeof(aP)=="string"){aO=aP}else{if(aP&&typeof(aP)=="object"&&aP.hasOwnProperty("streamId")){aO=aP.streamId}else{var aN="Session.forceUnpublish :: Invalid stream type";al(aN);throw new Error(aN)}}m("Session.forceUnpublish("+aO+")");if(aO){try{var aL=document.getElementById(aH);aL.forceUnpublish(aO)}catch(aM){aN="Session.forceUnpublish :: "+aM;al(aN);throw new Error(aN)}}else{aN="Session.forceUnpublish :: Stream does not exist.";al(aN);throw new Error(aN)}};this.subscribe=function(aV,aS,aR){if(!this.connection||!this.connection.connectionId){var aQ="Session.subscribe :: Connection required to subscribe";al(aQ);throw new Error(aQ)}if(!aV){aQ="Session.subscribe :: stream cannot be null";al(aQ);throw new Error(aQ)}if(!aV.hasOwnProperty("streamId")){aQ="Session.subscribe :: invalid stream object";al(aQ);throw new Error(aQ)}m("Session.subscribe("+aV.streamId+")");if(!aS){var aL=document.createElement("div");aS="subscriber_replace_"+this.sessionId+"_"+aI;aL.setAttribute("id",aS);document.body.appendChild(aL)}var aN=document.getElementById(aS);if(!aN){aQ="Session.subscribe :: replaceElementId does not exist in DOM.";al(aQ);throw new Error(aQ)}var aP=(aR)?au(aR):{};var aT="subscriber_"+aV.streamId+"_"+aI++;var aW=new R(aV,aT,aS,aP);var aM={};aM.allowscriptaccess="always";if(aP.wmode){aM.wmode=aP.wmode;delete aP.wmode}else{aM.wmode="transparent"}if(aP.hasOwnProperty("style")){aP.style=encodeURIComponent(H(aP.style))}var aO={};aO.id=aW.id;aO.style="outline:none;";aP.subscriberId=aT;aP.connectionId=this.connection.connectionId;aP.sessionId=this.sessionId;aP.streamId=aV.streamId;aP.streamType=aV.type;aP.name=aV.name;aP.token=this.token;aP.simulateMobile=TB.simulateMobile;aP.isPublishing=(Object.keys(this.publishers).length>0);if(!aV.hasAudio){aP.subscribeToAudio="false"}if(!aV.hasVideo){aP.subscribeToVideo="false"}aP.orientation=aV.orientation;aP.peerId=aV.peerId;if(!aP.width||isNaN(aP.width)){aP.width=aE}if(!aP.height||isNaN(aP.height)){aP.height=aG}this.subscribers[aW.id]=aW;var aU=new Date();aP.startTime=aU.getTime();J(u+"/v0.91.51.6094344/flash/f_subscribewidget.swf?partnerId="+this.apiKey,aS,aP.width,aP.height,q,false,aP,aM,aO);return aW};this.unsubscribe=function(aL){if(!aL){var aM="Subscribe.unsubscribe :: subscriber cannot be null";al(aM);throw new Error(aM)}m("Session.unsubscribe("+aL.id+")");l(aL);delete this.subscribers[aL.id]};this.signal=function(){m("Session.signal()");if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.sendSignal()}catch(aN){var aM="Session.signal :: "+aN;al(aM);throw new Error(aM)}}else{aM="Session.signal :: Connection required to signal.";al(aM);throw new Error(aM)}};this.forceDisconnect=function(aM){if(aM){m("Session.forceDisconnect("+aM.connectionId+")")}var aP;if(aM&&typeof(aM)=="string"){aP=aM}else{if(aM&&typeof(aM)=="object"&&aM.hasOwnProperty("connectionId")){aP=aM.connectionId}else{var aO="Session.forceDisconnect :: Invalid connection type";al(aO);throw new Error(aO)}}if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.forceDisconnect(aP)}catch(aN){aO="Session.forceDisconnect :: "+aN;al(aO);throw new Error(aO)}}else{aO="Session.forceDisconnect :: Connection required to forceDisconnect.";al(aO);throw new Error(aO)}};this.getSubscribersForStream=function(aP){var aL=null;if(!aP){var aN="Session.getSubscribersForStream :: stream cannot be null";al(aN);throw new Error(aN)}else{var aO;if(typeof(aP)=="string"){aO=aP}else{if(typeof(aP)=="object"&&aP.hasOwnProperty("streamId")){aO=aP.streamId}else{aN="Session.getSubscribersForStream :: Invalid stream type";al(aN);throw new Error(aN)}}aL=[];for(var aM in this.subscribers){if(this.subscribers[aM].hasOwnProperty("stream")&&this.subscribers[aM].stream.streamId==aO){aL.push(this.subscribers[aM])}}}return aL};this.getPublisherForStream=function(aQ){if(!aQ){var aO="Session.getPublisherForStream :: stream cannot be null";al(aO);throw new Error(aO)}else{var aP;if(typeof(aQ)=="string"){aP=aQ}else{if(typeof(aQ)=="object"&&aQ.hasOwnProperty("streamId")){aP=aQ.streamId}else{aO="Session.getPublisherForStream :: Invalid stream type";al(aO);throw new Error(aO)}}for(var aN in this.publishers){var aM=document.getElementById(this.publishers[aN].id);if(aM){try{if(aM.getStreamId()==aP){return this.publishers[aN]}}catch(aL){aD("Failed to get streamId for publisher: "+this.publishers[aN].id)}}}}return null};this.createArchive=function(aP,aM,aO){m("Session.createArchive()");if(aH&&this.connection&&this.connection.connectionId){if(aM==TB.PER_SESSION||aM==TB.PER_STREAM){try{var aL=document.getElementById(aH);aL.createArchive(aP,aM,aO)}catch(aN){errorMsg="Session.createArchive :: "+aN;al(errorMsg);throw new Error(errorMsg)}}else{errorMsg="Session.createArchive :: Invalid type specfied.";al(errorMsg);throw new Error(errorMsg)}}else{errorMsg="Session.createArchive :: Connection required to create an archive.";al(errorMsg);throw new Error(errorMsg)}};this.loadArchive=function(aO){m("Session.loadArchive()");if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.loadArchive(aO)}catch(aN){var aM="Session.loadArchive :: "+aN;al(aM);throw new Error(aM)}}else{aM="Session.loadArchive :: Connection required to load an archive.";al(aM);throw new Error(aM)}};this.startRecording=function(aM){m("Session.startRecording()");aM=v[this.sessionId][aM.archiveId];if(!aM){var aO="Session.startRecording :: Archive not created.";al(aO);throw new Error(aO)}if(aM.type!=TB.PER_SESSION){aO="Session.startRecording :: Trying to record per session on a "+aM.type+" archive";al(aO);throw new Error(aO)}if(aM.recording){aD("Session.startRecording :: Trying to start recording when the archive is already recording");return}if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.startRecordingSession(aM.archiveId);aM.recording=true}catch(aN){aO="Session.startRecording :: "+aN;al(aO);throw new Error(aO)}}else{aO="Session.startRecording :: Connection required to record an archive.";al(aO);throw new Error(aO)}};this.stopRecording=function(aM){m("Session.stopRecording()");aM=v[this.sessionId][aM.archiveId];if(!aM){var aO="Session.stopRecording :: Archive not created.";al(aO);throw new Error(aO)}if(aM.type!=TB.PER_SESSION){aO="Session.stopRecording :: Trying to stop recording per session on a "+aM.type+" archive";al(aO);throw new Error(aO)}if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.stopRecordingSession(aM.archiveId);aM.recording=false}catch(aN){aO="Session.stopRecording :: "+aN;al(aO);throw new Error(aO)}}else{aO="Session.stopRecording :: Connection required to record an archive.";al(aO);throw new Error(aO)}};this.closeArchive=function(aM){m("Session.closeArchive()");if(aH&&this.connection&&this.connection.connectionId){try{var aL=document.getElementById(aH);aL.closeArchive(aM.archiveId)}catch(aO){var aN="Session.closeArchive :: "+aO;al(aN);throw new Error(aN)}}else{aN="Session.closeArchive :: Connection required to close an archive.";al(aN);throw new Error(aN)}};this.getStateManager=function(){m("Session.getStateManager()");if(aJ){return aJ}else{if(aH&&this.connection&&this.connection.connectionId){aJ=new F(aH);return aJ}}var aL="Session.getStateManager :: Connection required to getState. Wait for sessionConnected before you getStateManager.";al(aL);throw new Error(aL)}}function F(aF,aG){this.superClass=aj;this.superClass();var aE=20;this.archiveId=aG;this.set=function(aK,aN){var aJ=aK;if(aG){var aM="StateManager.set :: not allowed on StateManager objects for archives.";al(aM);throw new Error(aM)}if(typeof(aK)=="string"&&(typeof(aN)=="string"||aN==null)){aJ={};aJ[aK]=aN}else{if(typeof(aK)=="object"&&aN==null){if(Object.keys(aJ).length>aE){al("StateManager.set :: Maximum number of keys exceeded");this.dispatchEvent(new Z("changeFailed",405,"Maximum number of keys exceeded",aJ));return}}else{aM="StateManager.set :: Invalid parameters passed. set() takes either two string parameters or one object of key value pairs.";al(aM);throw new Error(aM)}}for(var aI in aJ){if(typeof(aJ[aI])!="string"&&aJ[aI]!=null){al("StateManager.set :: Invalid value "+aJ[aI].toString()+" is not a string");this.dispatchEvent(new Z("changeFailed",403," Invalid value, value must be a string",aJ));return}}if(aF){try{var aH=document.getElementById(aF);aH.setState(aJ)}catch(aL){aM="StateManager.set :: "+aL;al(aM);throw new Error(aM)}}};this.superAddEventListener=this.addEventListener;this.addEventListener=function(aJ,aM){var aI=false;if(aJ=="changed"){aI=null}else{if(aJ.indexOf("changed:")==0){aI=aJ.split(":")[1]}}if(aI!==false){if(aG){aI="TB_archive_"+aG+"_"}if(aF){try{var aH=document.getElementById(aF);aH.subscribeToKeyChange(aI)}catch(aL){var aK="StateManager.addEventListener :: "+aL;al(aK);throw new Error(aK)}}}this.superAddEventListener(aJ,aM)}}function i(aE){if(!aE.success){al("Failed to embed SWF "+aE.id);TB.exceptionHandler("Failed to embed SWF "+aE.id,"Embed Failed",2001)}}function J(aH,aM,aJ,aL,aE,aG,aF,aI,aK){if(!swfobject.hasFlashPlayerVersion(aE)){al("Flash Player "+aE+" or higher required");TB.exceptionHandler("Flash Player "+aE+" or higher required","Embed Failed",2001);return}swfobject.embedSWF(aH,aM,aJ,aL,aE,aG,aF,aI,aK,i)}function ad(aF,aE){return function(){if(aF!=null){aF(aE)}else{al("Event handler is null")}}}function ai(aE){window.opentokdebug.debug("[FLASHDEBUG] opentok: "+aE)}function m(aE){window.opentokdebug.debug("[DEBUG] opentok: "+aE)}function j(aE){window.opentokdebug.info("[INFO] opentok: "+aE)}function aD(aE){window.opentokdebug.warn("[WARN] opentok: "+aE)}function al(aE){window.opentokdebug.error("[ERROR] opentok: "+aE)}function ar(aH,aF,aG){var aE=document.getElementById("opentok_console");if(aE){aE.innerHTML+=(aG+"<br>")}}function b(aF){if(P.hasOwnProperty(aF)){var aE=P[aF]}else{aE=new E(aF,NaN,null)}return aE}function t(aE,aF){return new O(aE.streamId,b(aE.connectionId),aE.name,aE.streamData,aE.type,aE.creationTime,aE.hasAudio,aE.hasVideo,aE.orientation,aF,aE.peerId,aE.quality)}function c(aF,aG){var aH=[];for(var aE=0;aE<aF.length;aE++){aH.push(t(aF[aE],aG))}return aH}function k(aE,aF){var aG=new s(aE.id,aE.type,aE.title,aF,aE.status);if(!v.hasOwnProperty(aF)){v[aF]={}}v[aF][aE.id]=aG;return aG}function af(aF){var aH=[];for(var aG=0;aG<aF.length;aG++){var aE=new E(aF[aG].connectionId,aF[aG].creationTime,aF[aG].data);aH.push(aE);P[aE.connectionId]=aE}return aH}function N(aE){if(aE.status==TB.ACTIVE){return new az(aE.name,TB.ACTIVE)}else{if(aE.status==TB.INACTIVE){return new az(aE.name,TB.INACTIVE)}else{return new az(aE.name,TB.UNKNOWN)}}}function C(aE){return new aw(aE.name,aE.status)}function w(aE){var aG=new Array();for(var aF=0;aF<aE.length;aF++){aG.push(new az(aE[aF].name,aE[aF].status))}return aG}function x(aE){var aG=new Array();for(var aF=0;aF<aE.length;aF++){aG.push(new aw(aE[aF].name,aE[aF].status))}return aG}function aa(aE){if(!aE.hasOwnProperty("id")){return}var aF=document.getElementById(aE.id);if(aF){try{aF.cleanupView()}catch(aG){aD("Disconnecting "+aE.id+" failed")}}else{aD("Disconnecting "+aE.id+" failed")}}function l(aF){var aG=document.getElementById(aF.id);if(aG){try{aG.cleanupView();var aE=aG.parentNode;aE.removeChild(aG)}catch(aH){aD("Removing "+aF.id+" failed "+aH)}}else{aD("Element "+aF.id+" does not exist")}}function ak(aE,aH){try{if(aE){swfobject.removeSWF(aE);aE=null}}catch(aG){var aF=aH+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}}function g(aJ,aI,aH){var aE=document.getElementById(aJ);if(aE){try{aE.setStreamProperty(aI,aH)}catch(aG){var aF="Changing settings on component "+aJ+" failed.";al(aF);throw new Error(aF)}}else{aF="Component "+aJ+" does not exist.";al(aF);throw new Error(aF)}}function f(aJ,aI,aE){var aF=document.getElementById(aJ);if(aF){try{if(aE){aF.setCamera(aI.name)}else{aF.setMicrophone(aI.name)}}catch(aH){var aG="Changing hardware settings on publisher "+aJ+" failed.";al(aG);throw new Error(aG)}}else{aG="Publisher "+aJ+" does not exist.";al(aG);throw new Error(aG)}}function Q(aK,aH){aH=aH||Infinity;aK=aK||document.body;var aL,aM,aJ=1,aG=[],aI=0;var aF=aK.childNodes,aE=aF.length;while(aI<aE){aL=aF[aI++];if(aL.nodeType!=1){continue}if(M(aL,"position")!=="static"){aM=M(aL,"z-index");if(aM=="auto"){aM=Q(aL)}else{aM=parseInt(aM,10)||0}}else{aM=Q(aL)}if(aM>aJ&&aM<=aH){aJ=aM}}return aJ}function M(aH,aG){var aE,aI,aF=document.defaultView||window;if(aH.nodeType==1){aE=aG.replace(/\-([a-z])/g,function(aK,aJ){return aJ.toUpperCase()});aI=aH.style[aE];if(!aI){if(aH.currentStyle){aI=aH.currentStyle[aE]}else{if(aF.getComputedStyle){aI=aF.getComputedStyle(aH,"").getPropertyValue(aG)}}}}return aI||""}function T(aG,aF){var aH=document.createElement(aG);for(var aE in aF){aH.setAttribute(aE,aF[aE])}return aH}function aB(aG,aF,aH){var aE=document.createElement("input");aE.setAttribute("name",aF);aE.setAttribute("value",aH);aE.setAttribute("type","hidden");aG.appendChild(aE)}function L(aI,aH,aG){var aF=function(){aH.submit();setTimeout(function(){var aJ=document.getElementById(aI);if(aJ){aJ.parentNode.removeChild(aJ)}if(aG===true){aH.parentNode.removeChild()}},1000)};aH.setAttribute("target",aI);var aE=T("iframe",{id:aI,name:aI,style:"display:none;width:0;height:0;"});aE.onload=aF;document.body.appendChild(aE);if(aE.attachEvent){aE.attachEvent("onload",aF)}}function ah(aE){try{var aF=document.getElementById(aE);if(aF){return aF.fetchData()}}catch(aG){aD("Failed to get logs for "+aE+" "+aG);return""}}function H(aF){var aE="{ ";for(var aG in aF){if(typeof(aF[aG])=="boolean"){aE+='"'+aG+'":'+aF[aG]+", "}else{aE+='"'+aG+'":"'+aF[aG].toString()+'", '}}if(aE.length>1){aE=aE.substring(0,aE.length-2)+" }"}else{aE="{}"}return aE}function au(aG){var aE=(aG instanceof Array)?[]:{};for(var aF in aG){if(aF=="clone"){continue}if(aG[aF]&&typeof aG[aF]=="object"){aE[aF]=au(aG[aF])}else{aE[aF]=aG[aF]}}return aE}this.isUnloading=false;window.onunload=function(){isUnloading=true;for(var aE in TB.sessions){if(TB.sessions[aE].hasOwnProperty("disconnect")){TB.sessionDisconnectedHandler=function(){};TB.sessions[aE].disconnect();TB.sessions[aE].cleanupConnection();TB.sessions[aE].cleanup()}}};var q="10.0.0";var ae=215;var e=138;var n;var r;var aC;var ay=false;var y=false;var P={};var B="true";var u="http://static.opentok.com";var ac=u+"/opentok/assets/flash/expressInstall.swf";if(B=="true"&&window.location.protocol=="https:"){u="https://swww.tokbox.com"}var A=new aj();var v={};var W={};var ao=false;return{sessions:{},LOG:5,DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0,ACTIVE:"active",INACTIVE:"inactive",UNKNOWN:"unknown",PER_SESSION:"perSession",PER_STREAM:"perStream",EXCEPTION:"exception",SESSION_CONNECTED:"sessionConnected",SESSION_DISCONNECTED:"sessionDisconnected",STREAM_CREATED:"streamCreated",STREAM_DESTROYED:"streamDestroyed",CONNECTION_CREATED:"connectionCreated",CONNECTION_DESTROYED:"connectionDestroyed",SIGNAL_RECEIVED:"signalReceived",STREAM_PROPERTY_CHANGED:"streamPropertyChanged",MICROPHONE_LEVEL_CHANGED:"microphoneLevelChanged",ARCHIVE_CREATED:"archiveCreated",ARCHIVE_CLOSED:"archiveClosed",ARCHIVE_LOADED:"archiveLoaded",ARCHIVE_SAVED:"archiveSaved",SESSION_RECORDING_STARTED:"sessionRecordingStarted",SESSION_RECORDING_STOPPED:"sessionRecordingStopped",SESSION_RECORDING_IN_PROGRESS:"sessionRecordingInProgress",STREAM_RECORDING_IN_PROGRESS:"streamRecordingInProgress",SESSION_NOT_RECORDING:"sessionNotRecording",STREAM_RECORDING_STARTED:"streamRecordingStarted",STREAM_RECORDING_STOPPED:"streamRecordingStopped",PLAYBACK_STARTED:"playbackStarted",PLAYBACK_STOPPED:"playbackStopped",RECORDING_STARTED:"recordingStarted",RECORDING_STOPPED:"recordingStopped",RESIZE:"resize",SETTINGS_BUTTON_CLICK:"settingsButtonClick",DEVICE_INACTIVE:"deviceInactive",ACCESS_ALLOWED:"accessAllowed",ACCESS_DENIED:"accessDenied",ECHO_CANCELLATION_MODE_CHANGED:"echoCancellationModeChanged",DEVICES_DETECTED:"devicesDetected",DEVICES_SELECTED:"devicesSelected",CLOSE_BUTTON_CLICK:"closeButtonClick",HAS_REQUIREMENTS:1,OLD_FLASH_VERSION:0,BASIC_STREAM:"basic",ARCHIVED:"archive",simulateMobile:false,setLogLevel:function(aE){window.opentokdebug.setLevel(aE);if(aE==this.NONE){window.opentokdebug.setCallback(null)}else{window.opentokdebug.setCallback(ar,true)}m("TB.setLogLevel("+aE+")")},log:function(aE){window.opentokdebug.log("[LOG] opentok: "+aE)},initSession:function(aF){m("TB.initSession("+aF+")");if(aF==null||aF==""){var aE="TB.initSession :: sessionId cannot be null";al(aE);throw new Error(aE)}if(!this.sessions.hasOwnProperty(aF)){this.sessions[aF]=new D(aF)}return this.sessions[aF]},initDeviceManager:function(aF){m("TB.initDeviceManager("+aF+")");if(!aF){var aE="TB.initDeviceManager :: apiKey cannot be null";al(aE);throw new Error(aE)}if(!n){n=new ax(aF)}return n},initRecorderManager:function(aF){m("TB.initRecorderManager("+aF+")");if(!aF){var aE="TB.initRecorderManager :: apiKey cannot be null";al(aE);throw new Error(aE)}if(!r){r=new av(aF)}return r},addEventListener:function(aE,aF){m("TB.addEventListener("+aE+")");A.addEventListener(aE,aF)},removeEventListener:function(aE,aF){m("TB.removeEventListener("+aE+")");A.removeEventListener(aE,aF)},dispatchEvent:function(aE){m("TB.dispatchEvent()");aE.target=this;A.dispatchEvent(aE)},checkSystemRequirements:function(){m("TB.checkSystemRequirements()");return swfobject.hasFlashPlayerVersion(q)?this.HAS_REQUIREMENTS:this.OLD_FLASH_VERSION},upgradeFlash:function(aG,aF,aE){aF=aF||215;aE=aE||140;swfobject.addDomLoadEvent(function(){if(!aG){aG="_"+Math.round(Math.random()*1000000000);document.body.appendChild((function(){var aK=document.createElement("div");aK.style.position="absolute";aK.style.height=aE+"px";aK.style.top="200px";aK.style.left="50%";aK.style.width=aF+"px";aK.style.marginLeft="-"+(aF/2)+"px";aK.style.marginTop="-67.5px";aK.style.zIndex=2;aK.style.boxShadow="5px 5px 10px black";aK.innerHTML='<div id="'+aG+'"></div>';return aK})())}var aJ={allowscriptaccess:"always",cameraSelected:false,wmode:"transparent"},aI={id:aG,style:"outline:none;"},aH={};J(ac,aG,aF,aE,"6",false,aH,aJ,aI)})},exceptionHandler:function(aI,aH,aG){al("TB.exception :: title: "+aH+" msg: "+aI+" errorCode: "+aG);try{this.dispatchEvent(new z(this.EXCEPTION,aI,aH,aG))}catch(aF){var aE="TB.exception :: Failed to dispatch exception - "+aF;al(aE)}},controllerLoadedHandler:function(){ao=true},controllerLoadCheck:function(aF){if(!ao){var aE="The connection timed out. Make sure that you have allowed this page in theFlash Player Global Settings Manager. Go to:";adobeURL="http://www.macromedia.com/Comm/documentation/en/flashplayer/help/settings_manager04.html";prompt(aE,adobeURL)}},flashLogger:function(aE){ai(aE)},destroyStreamHandler:function(aJ,aE){m("TB.destroyStream");try{var aI=this.sessions[aJ];var aK=c(aE,aJ);var aH=function(){for(var aL=0;aL<aK.length;aL++){var aM=aI.getPublisherForStream(aK[aL]);if(aM){aI.unpublish(aM)}}};setTimeout(aH,2)}catch(aG){var aF="TB.destroyStream :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},sessionConnectedHandler:function(aK,aM,aE,aG,aF,aR,aP){m("TB.sessionConnected");try{var aO=this.sessions[aK];for(var aJ=0,aN=aE.length;aJ<aN;aJ++){connection=aE[aJ];if(connection.connectionId==aM){aO.connection=new E(aM,connection.creationTime,connection.data);break}}aO.connected=true;aO.connecting=false;aO.connection.quality=aR;aO.capabilities=aF;var aT=af(aE);var aS=c(aG,aO.sessionId);var aQ=[];for(var aJ=0;aJ<aP.length;aJ++){var aH=k(aP[aJ],aK);aQ.push(aH)}aO.dispatchEvent(new aA(this.SESSION_CONNECTED,aT,aS,aQ))}catch(aI){var aL="TB.sessionConnected :: "+aI;al(aL);TB.exceptionHandler(aL,"Internal Error",2000)}},sessionDisconnectedHandler:function(aK,aJ){m("TB.sessionDisconnected("+aJ+")");try{var aI=this.sessions[aK];aI.disconnectComponents();aI.cleanupConnection();aI.connected=false;var aH=new p(this.SESSION_DISCONNECTED,aJ,true);aI.dispatchEvent(aH);var aE=function(){if(!aH.isDefaultPrevented()){aI.cleanup()}};setTimeout(aE,2)}catch(aG){var aF="TB.sessionDisconnected :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},streamCreatedHandler:function(aI,aF,aL){m("TB.streamCreated");try{var aN=this.sessions[aI];var aP=c(aF,aI);aN.dispatchEvent(new ap(this.STREAM_CREATED,aP,aL));var aO=v[aI];for(var aJ in aO){for(var aK=0;aK<aP.length;aK++){if(aP[aK].connection.connectionId==connection.connectionId){for(var aH in aN.publishers){if(aN.publishers[aH].hasOwnProperty("id")){var aE=document.getElementById(aN.publishers[aH].id);if(aJ&&aO[aJ]&&aO[aJ].type==TB.PER_SESSION&&aO[aJ].recording==true){aE.signalRecordingStarted()}}}}}}}catch(aG){var aM="TB.streamCreated :: "+aG;al(aM);TB.exceptionHandler(aM,"Internal Error",2000)}},streamDestroyedHandler:function(aH,aF,aI){m("TB.streamDestroyed");try{var aL=this.sessions[aH];var aM=c(aF,aH);var aE=new ap(this.STREAM_DESTROYED,aM,aI,true);aL.dispatchEvent(aE);var aK=function(){if(!aE.isDefaultPrevented()){for(var aO=0;aO<aE.streams.length;aO++){var aQ=aL.getSubscribersForStream(aE.streams[aO]);for(var aN=0;aN<aQ.length;aN++){aL.unsubscribe(aQ[aN])}var aP=aL.getPublisherForStream(aE.streams[aO]);if(aP){aL.unpublish(aP)}}}};setTimeout(aK,2)}catch(aG){var aJ="TB.streamDestroyed :: "+aG;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000)}},streamPropertyChangedHandler:function(aK,aI,aG,aE,aH){m("TB.streamPropertyChangedHandler");var aN=this.sessions[aK];var aO=t(aI,aK);var aF=new K(this.STREAM_PROPERTY_CHANGED,aO,aG,aE,aH);aN.dispatchEvent(aF);try{var aP;if("hasAudio"==aG){for(var aM in aN.subscribers){aP=aN.subscribers[aM];if(aP.hasOwnProperty("stream")&&aP.stream.streamId==aO.streamId){aP._subscribeToAudio(aH,true);break}}}else{if("hasVideo"==aG){for(aM in aN.subscribers){aP=aN.subscribers[aM];if(aP.hasOwnProperty("stream")&&aP.stream.streamId==aO.streamId){aP._subscribeToVideo(aH,true);break}}}else{if("orientation"==aG){for(aM in aN.subscribers){aP=aN.subscribers[aM];if(aP.hasOwnProperty("stream")&&aP.stream.streamId==aO.streamId){aP.changeOrientation(aH);break}}}else{if("quality"==aG){}else{m("Unknown property changed")}}}}}catch(aJ){var aL="TB.streamPropertyChangedHandler :: "+aJ;al(aL);TB.exceptionHandler(aL,"Internal Error",2000)}},microphoneLevelChangedHandler:function(aH,aL,aE,aI){try{var aK=this.sessions[aH];if(!aK){var aJ="TB.microphoneLevelChangedHandler :: Invalid session ID: "+aH;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000);return}var aM=aK.subscribers[aL];var aF=new X(this.MICROPHONE_LEVEL_CHANGED,aE,aI);aK.dispatchEvent(aF)}catch(aG){aJ="microphoneLevelChanged :: "+aG;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000)}},connectionCreatedHandler:function(aK,aE,aJ){m("TB.connectionCreated");try{var aI=this.sessions[aK];var aF=af(aE);aI.dispatchEvent(new an(this.CONNECTION_CREATED,aF,aJ))}catch(aH){var aG="TB.connectionCreated :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},connectionDestroyedHandler:function(aK,aE,aJ){m("TB.connectionDestroyed");try{var aI=this.sessions[aK];var aF=af(aE);aI.dispatchEvent(new an(this.CONNECTION_DESTROYED,aF,aJ))}catch(aH){var aG="TB.connectionDestroyed :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},signalHandler:function(aI,aE){m("TB.signal");try{var aH=this.sessions[aI];aH.dispatchEvent(new at(this.SIGNAL_RECEIVED,b(aE)))}catch(aG){var aF="TB.signal ::"+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},archiveCreatedHandler:function(aI,aE){m("TB.archiveCreatedHandler:"+aI+" - "+aE);try{var aH=this.sessions[aI];var aJ=k(aE,aI);aH.dispatchEvent(new am(this.ARCHIVE_CREATED,[aJ]))}catch(aG){var aF="TB.archiveCreatedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},archiveClosedHandler:function(aI,aE){m("TB.archiveClosedHandler:"+aI+" - "+aE.id);try{var aH=this.sessions[aI];aH.dispatchEvent(new am(this.ARCHIVE_CLOSED,[v[aI][aE.id]]));delete v[aI][aE.id]}catch(aG){var aF="TB.archiveClosedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},archiveLoadedHandler:function(aI,aE){m("TB.archiveLoadedHandler:"+aI+" - "+aE.archiveId);try{var aH=this.sessions[aI];var aJ=new s(aE.id,aE.type,aE.title,aI);if(!W.hasOwnProperty(aI)){W[aI]={}}W[aI][aE.id]=aJ;aH.dispatchEvent(new am(this.ARCHIVE_LOADED,[aJ]))}catch(aG){var aF="TB.archiveLoadedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},sessionRecordingStartedHandler:function(aI,aE){m("TB.sessionRecordingStartedHandler:"+aI+" - "+aE.id);try{var aH=this.sessions[aI];aH.dispatchEvent(new am(this.SESSION_RECORDING_STARTED,[v[aI][aE.id]]))}catch(aG){var aF="TB.sessionRecordingStartedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},sessionRecordingStoppedHandler:function(aK,aE){m("TB.sessionRecordingStoppedHandler:"+aK+" - "+aE);try{var aJ=this.sessions[aK];aJ.dispatchEvent(new am(this.SESSION_RECORDING_STOPPED,[v[aK][aE.id]]));for(var aI in aJ.publishers){if(aJ.publishers[aI].hasOwnProperty("id")){var aH=document.getElementById(aJ.publishers[aI].id);aH.signalRecordingStopped()}}}catch(aG){var aF="TB.sessionRecordingStoppedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},sessionRecordingInProgressHandler:function(aH){m("TB.sessionRecordingInProgressHandler");try{var aG=this.sessions[aH];aG.dispatchEvent(new I(this.SESSION_RECORDING_IN_PROGRESS,false))}catch(aF){var aE="TB.sessionRecordingStartedHandler :: "+aF;al(aE);TB.exceptionHandler(aE,"Internal Error",2000)}},sessionNotRecordingHandler:function(aH){m("TB.sessionNotRecordingHandler");try{var aG=this.sessions[aH];aG.dispatchEvent(new I(this.SESSION_NOT_RECORDING,false))}catch(aF){var aE="TB.sessionNotRecordingHandler :: "+aF;al(aE);TB.exceptionHandler(aE,"Internal Error",2000)}},streamRecordingStartedHandler:function(aI,aF){m("TB.streamRecordingStartedHandler:"+aI);try{var aL=this.sessions[aI];var aM=c(aF,aI);aL.dispatchEvent(new ap(this.STREAM_RECORDING_STARTED,aM,"",false));for(var aH in aL.publishers){if(aL.publishers[aH].hasOwnProperty("id")){var aE=document.getElementById(aL.publishers[aH].id);for(var aJ=0;aJ<aF.length;aJ++){if(aE.getStreamId()==aF[aJ].streamId){aE.signalRecordingStarted();m("TB.streamRecordingStartedHandler: signal: "+aF[aJ].streamId);break}}}}}catch(aG){var aK="TB.streamRecordingStartedHandler :: "+aG;al(aK);TB.exceptionHandler(aK,"Internal Error",2000)}},streamRecordingStoppedHandler:function(aI,aF){m("TB.streamRecordingStoppedHandler");try{var aL=this.sessions[aI];var aM=c(aF,aI);aL.dispatchEvent(new ap(this.STREAM_RECORDING_STOPPED,aM,"",false));for(var aH in aL.publishers){if(aL.publishers[aH].hasOwnProperty("id")){var aE=document.getElementById(aL.publishers[aH].id);for(var aJ=0;aJ<aF.length;aJ++){if(aE.getStreamId()==aF[aJ].streamId){aE.signalRecordingStopped();m("TB.streamRecordingStoppedHandler: signal: "+aF[aJ].streamId);break}}}}}catch(aG){var aK="TB.streamRecordingStoppedHandler :: "+aG;al(aK);TB.exceptionHandler(aK,"Internal Error",2000)}},streamRecordingInProgressHandler:function(aI,aE){m("TB.streamRecordingInProgressHandler");try{var aH=this.sessions[aI];var aJ=c(aE,aI);aH.dispatchEvent(new ap(this.STREAM_RECORDING_IN_PROGRESS,aJ,"",false))}catch(aG){var aF="TB.streamRecordingInProgressHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},playbackStartedHandler:function(aI,aE){m("TB.playbackStartedHandler");try{var aH=this.sessions[aI];archiveObj=new s(aE.id,aE.type,aE.title,aI);aH.dispatchEvent(new am(this.PLAYBACK_STARTED,[archiveObj]))}catch(aG){var aF="TB.playbackStartedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},playbackStoppedHandler:function(aI,aE){m("TB.playbackStoppedHandler");try{var aH=this.sessions[aI];archiveObj=new s(aE.id,aE.type,aE.title,aI);aH.dispatchEvent(new am(this.PLAYBACK_STOPPED,[archiveObj]))}catch(aG){var aF="TB.playbackStoppedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},videoComponentLoadedHandler:function(aG,aJ){try{if(aG){var aI=this.sessions[aG];if(!aI){return}var aE=aI.publishers[aJ];var aN=aI.subscribers[aJ];if(aE&&!aE.loaded){aE.loaded=true;if(aE.modified){if(aE.audioPublished!=null){aE.publishAudio(aE.audioPublished)}if(aE.videoPublished!=null){aE.publishVideo(aE.videoPublished)}aE.setMicrophoneGain(aE.gain);aE.setStyle(aE._style);aE.modified=false}aE.dispatchEvent(new I("loaded"))}if(aN&&!aN.loaded){aN.loaded=true;if(aN.modified){if(aN.audioSubscribed!=null){aN.subscribeToAudio(aN.audioSubscribed)}if(aN.videoSubscribed!=null){aN.subscribeToVideo(aN.videoSubscribed)}aN.setAudioVolume(aN.audioVolume);aN.setStyle(aN._style);aN.modified=false}aN.dispatchEvent(new I("loaded"))}}else{var aL=r.players[aJ];if(aL&&aL._archiveId){aL.loadArchive(aL._archiveId);aL._archiveId=null}if(aL&&aL._play){aL.play();aL._play=false}var aM=r.recorders[aJ];var aK=aL?aL:aM;if(aK&&!aK.loaded){aK.loaded=true;if(aK.modified){aK.setStyle(aK._style);if(aK==aM&&aK._title){aK.setTitle(_title);_title=""}aK.modified=false}aK.dispatchEvent(new I("loaded"))}}}catch(aF){var aH="videoComponentLoaded:: initialize component "+aJ+" - "+aF;al(aH);TB.exceptionHandler(aH,"Internal Error",2000)}},videoWidgetStyleHeightFrom:null,videoWidgetStyleWidthFrom:null,resizeVideoComponentToTarget:function(aM,aQ){m("TB.resize");var aP=this.sessions[aM];var aF=aP&&aP.publishers.hasOwnProperty(aQ);var aE=(aF)?"publisher":"recorder";try{if(!aP&&aF){var aO="TB.resize :: Invalid session ID: "+aM;al(aO);TB.exceptionHandler(aO,"Internal Error",2000);return}var aG=(aF)?aP.publishers[aQ]:r.recorders[aQ];if(!aG){aO="TB.resize :: Invalid "+aE+" ID: "+aQ;al(aO);TB.exceptionHandler(aO,"Internal Error",2000);return}var aH=document.getElementById(aQ);if(!aH){aO="TB.resize :: "+aE+" "+aQ+" does not exist in the DOM";al(aO);TB.exceptionHandler(aO,"Internal Error",2000);return}var aN=aH.width;var aL=aH.height;if(aH.width!=aG.properties.width){aH.width=aG.properties.width}if(aH.height!=aG.properties.height){aH.height=aG.properties.height}if(aH.style.height!=videoWidgetStyleHeightFrom){aH.style.height=videoWidgetStyleHeightFrom}if(aH.style.width!=videoWidgetStyleWidthFrom){aH.style.width=videoWidgetStyleWidthFrom}var aJ=aH.width;var aK=aH.height;if(aN!=aJ||aL!=aK){aG.dispatchEvent(new h(this.RESIZE,aN,aJ,aL,aK))}}catch(aI){aO="resizeVideoComponentToTarget :: Error resizing "+aE+" - "+aI;al(aO);TB.exceptionHandler(aO,"Internal Error",2000)}},resizeVideoComponentToShowSecurity:function(aN,aR,aS){m("TB.resize");var aQ=this.sessions[aN];var aG=aQ&&aQ.publishers.hasOwnProperty(aR);var aF=(aG)?"publisher":"recorder";if(!aQ&&aG){var aP="TB.resize :: Invalid session ID: "+aN;al(aP);TB.exceptionHandler(aP,"Internal Error",2000);return}var aH=(aG)?aQ.publishers[aR]:r.recorders[aR];if(!aH){aP="TB.resize :: Invalid "+aF+" ID: "+aR;al(aP);TB.exceptionHandler(aP,"Internal Error",2000);return}var aI=document.getElementById(aR);if(!aI){aP="TB.resize :: "+aF+" "+aR+" does not exist in the DOM";al(aP);TB.exceptionHandler(aP,"Internal Error",2000);return}var aO=aH.properties.width=aI.width;var aM=aH.properties.height=aI.height;videoWidgetStyleHeightFrom=aI.style.height;videoWidgetStyleWidthFrom=aI.style.width;var aE=ae*aS;var aT=e*aS;if(aI.width<aE){aI.width=aE;aI.style.width=aE+"px"}if(aI.height<aT){aI.height=aT;aI.style.height=aT+"px"}var aK=aI.width;var aL=aI.height;var aJ=aI.style;if(aO!=aK||aM!=aL||videoWidgetStyleWidthFrom!=aJ.width||videoWidgetStyleHeightFrom!=aJ.height){aH.dispatchEvent(new h(this.RESIZE,aO,aK,aM,aL))}},settingsButtonClickHandler:function(aL,aE){m("TB.settingsButtonClick");try{var aK=this.sessions[aL];if(!aK){var aJ="TB.settingsButtonClick :: Invalid session ID: "+aL;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000);return}var aI=aK.publishers[aE];if(!aI){aJ="TB.settingsButtonClick :: Invalid publisher ID: "+aE;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000);return}var aH=new I(this.SETTINGS_BUTTON_CLICK,true);aI.dispatchEvent(aH);var aF=function(){if(!aH.isDefaultPrevented()){var aM=TB.initDeviceManager(aK.apiKey);aM.displayPanel(null,aI,{})}};setTimeout(aF,2)}catch(aG){aJ="settingsButtonClick :: "+aG;al(aJ);TB.exceptionHandler(aJ,"Internal Error",2000)}},recorderSettingsButtonClickHandler:function(aI){m("TB.recorderSettingsButtonClick");try{var aE=r.recorders[aI];if(!aE){errorMsg="TB.recorderSettingsButtonClick :: Invalid recorder ID: "+aI;al(errorMsg);TB.exceptionHandler(errorMsg,"Internal Error",2000);return}var aH=new I(this.SETTINGS_BUTTON_CLICK,true);aE.dispatchEvent(aH);var aF=function(){if(!aH.isDefaultPrevented()){var aJ=TB.initDeviceManager(r.apiKey);aJ.displayPanel(null,aE,{})}};setTimeout(aF,2)}catch(aG){errorMsg="recorderSettingsButtonClick :: "+aG;al(errorMsg);TB.exceptionHandler(errorMsg,"Internal Error",2000)}},deviceAccessHandler:function(aJ,aO,aN){var aM=this.sessions[aJ];var aG=aM&&aM.publishers.hasOwnProperty(aO);var aF=(aG)?"publisher":"recorder";m("TB.deviceAccessHandler: "+aN);try{if(aG&&!aM){var aL="TB.deviceAccessHandler :: Invalid session ID: "+aJ;al(aL);TB.exceptionHandler(aL,"Internal Error",2000);return}var aH=(aG)?aM.publishers[aO]:r.recorders[aO];if(!aH){aL="TB.deviceAccessHandler :: Invalid "+aF+" ID: "+aO;al(aL);TB.exceptionHandler(aL,"Internal Error",2000);return}var aE=new I(aN,true);aH.dispatchEvent(aE);if(aG&&(aN==TB.ACCESS_DENIED)){var aK=function(){var aR=document.getElementById(aH.id);if(aR){var aP=aR.parentNode;aM.unpublish(aH);var aQ=document.createElement("div");aQ.setAttribute("id",aH.replacedDivId);aP.appendChild(aQ);aM._embedPublisher(aH)}};setTimeout(aK,2)}}catch(aI){aL=aN+" :: "+aI;al(aL);TB.exceptionHandler(aL,"Internal Error",2000)}},deviceInactiveHandler:function(aH,aK,aJ,aM){m("TB.deviceInactiveHandler");try{var aL=this.sessions[aH];if(!aL){var aI="TB.deviceInactiveHandler :: Invalid session ID: "+aH;al(aI);TB.exceptionHandler(aI,"Internal Error",2000);return}var aE=aL.publishers[aK];if(!aE){al("TB.deviceInactiveHandler :: Invalid publisher ID: "+aK);return}var aF=new d(this.DEVICE_INACTIVE,aJ,aM);aE.dispatchEvent(aF)}catch(aG){aI="deviceInactive :: "+aG;al(aI);TB.exceptionHandler(aI,"Internal Error",2000)}},echoCancellationModeChangedHandler:function(aH,aK,aJ,aM){m("TB.echoCancellationModeChangedHandler");try{var aL=this.sessions[aH];if(!aL){var aI="TB.echoCancellationModeChangedHandler :: Invalid session ID: "+aH;al(aI);TB.exceptionHandler(aI,"Internal Error",2000);return}var aE=aL.publishers[aK];if(!aE){al("TB.echoCancellationModeChangedHandler :: Invalid publisher ID: "+aK);return}var aF=new d(this.ECHO_CANCELLATION_MODE_CHANGED,aJ,aM);aE.dispatchEvent(aF)}catch(aG){aI="echoCancellationModeChanged :: "+aG;al(aI);TB.exceptionHandler(aI,"Internal Error",2000)}},devicesDetectedHandler:function(aG,aF,aE,aI){m("TB.devicesDetected");try{var aH=w(aG);var aJ=x(aF);n.dispatchEvent(new V(this.DEVICES_DETECTED,aH,aJ,aH[aE],aJ[aI]));setTimeout(function(){ak(aC,"devicesDetectedHandler :: ");aC=null},0)}catch(aL){var aK="devicesDetectedHandler :: "+aL;al(aK);TB.exceptionHandler(aK,"Internal Error",2000)}},devicesSelectedHandler:function(aE,aF,aI){m("TB.devicesSelected");try{ay=true;var aJ=n.panels[aE];if(!aJ){al("TB.devicesSelected :: Invalid DevicePanel ID: "+aE);return}if(aJ.component){aJ.component.setCamera(aF);aJ.component.setMicrophone(aI)}aJ.dispatchEvent(new d(this.DEVICES_SELECTED,aF,aI))}catch(aH){var aG="devicesSelected :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},closeButtonClickHandler:function(aE){m("TB.closeButtonClick");try{var aJ=n.panels[aE];if(!aJ){var aI="TB.devicesSelected :: Invalid DevicePanel ID: "+aE;al(aI);TB.exceptionHandler(aI,"Internal Error",2000);return}var aH=new I(this.CLOSE_BUTTON_CLICK,true);aJ.dispatchEvent(aH);var aF=function(){if(!aH.isDefaultPrevented()){n.removePanel(aJ)}};setTimeout(aF,2)}catch(aG){aI="closeButtonClick :: "+aG;al(aI);TB.exceptionHandler(aI,"Internal Error",2000)}},playerArchiveLoadedHandler:function(aE){m("Player.archiveLoadedHandler");try{var aF=r.players[aE];aF.dispatchEvent(new I(this.ARCHIVE_LOADED))}catch(aH){var aG="Player.archiveLoadedHandler :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},playingStartedHandler:function(aE){m("Player.playingHandler");try{var aF=r.players[aE];aF.dispatchEvent(new I(this.PLAYBACK_STARTED))}catch(aH){var aG="Player.playingStartedHandler :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},playingStoppedHandler:function(aE,aG){m("Player.playingStoppedHandler");try{var aF=r.players[aE];aF.dispatchEvent(new I(this.PLAYBACK_STOPPED))}catch(aI){var aH="Player.playingStoppedHandler :: "+aI;al(aH);TB.exceptionHandler(aH,"Internal Error",2000)}},recordingStartedHandler:function(aH){m("Recorder.recordingStartedHandler");try{var aE=r.recorders[aH];aE.dispatchEvent(new I(this.RECORDING_STARTED))}catch(aG){var aF="Recorder.recordingStartedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},recordingStoppedHandler:function(aH){m("Recorder.recordingStoppedHandler");try{var aE=r.recorders[aH];aE.dispatchEvent(new I(this.RECORDING_STOPPED))}catch(aG){var aF="Recorder.recordingStoppedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},recorderPlaybackStartedHandler:function(aH){m("Recorder.playbackStartedddHandler");try{var aE=r.recorders[aH];aE.dispatchEvent(new I(this.PLAYBACK_STARTED))}catch(aG){var aF="Recorder.playbackStartedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},recorderPlaybackStoppedHandler:function(aH){m("Recorder.playbackStoppedHandler");try{var aE=r.recorders[aH];aE.dispatchEvent(new I(this.PLAYBACK_STOPPED))}catch(aG){var aF="Recorder.playbackStoppedHandler :: "+aG;al(aF);TB.exceptionHandler(aF,"Internal Error",2000)}},archiveSavedHandler:function(aI,aF){m("Recorder.archiveSavedHandler");try{var aE=r.recorders[aI];var aJ=new s(aF.id,aF.type,aF.title);aE.dispatchEvent(new am(this.ARCHIVE_SAVED,[aJ]))}catch(aH){var aG="Recorder.archiveSavedHandler :: "+aH;al(aG);TB.exceptionHandler(aG,"Internal Error",2000)}},stateChangedHandler:function(aE,aM){m("TB.stateChangeHandler");var aK=this.sessions[aE];if(!aK){var aG="TB.stateChangedHandler :: Invalid session ID: "+aE;al(aG);TB.exceptionHandler(aG,"Internal Error",2000);return}function aJ(aP){aP=aP.replace(/"/g,"");var aN=aP.match(/TB_archive_([^_]+)_(.*)/);if(aN){archiveId=aN[1];aP=aN[2];var aO=W[aE][archiveId];if(!aO){var aQ="Archive.startPlayback :: Archive not loaded.";al(aQ);TB.exceptionHandler(aQ,"Internal Error",2000);return}return aO.getStateManager()}return aK.getStateManager()}var aI=false;for(var aL in aM){var aH=aJ(aL);if(!aI){aH.dispatchEvent(new U("changed",aM));aI=true}var aF={};aF[aL]=aM[aL];aH.dispatchEvent(new U("changed:"+aL,aF))}if(!aI){aK.getStateManager().dispatchEvent(new U("changed",aM))}},stateChangedFailedHandler:function(aK,aJ,aH,aI){m("TB.stateChangedFailedHandler reasonCode:"+aJ+" reason:"+aH);var aG=this.sessions[aK];if(!aG){var aF="TB.stateChangedFailedHandler :: Invalid session ID: "+aK;al(aF);TB.exceptionHandler(aF,"Internal Error",2000);return}var aE=aG.getStateManager();aE.dispatchEvent(new Z("changeFailed",aJ,aH,aI))},reportIssueHandler:function(aX,aK,aV){m("TB.reportIssue");if(aK==null){aK=false}if(y){return}var aG=document.createElement("form");aG.setAttribute("action","http://www.tokbox.com/reportIssue.php");aG.setAttribute("method","post");aG.setAttribute("target","formresult");aB(aG,"issueId",aX);aB(aG,"userAgent",navigator.userAgent);aB(aG,"environment","JS");var aJ=swfobject.getFlashPlayerVersion();aB(aG,"flashVersion",aJ.major+"."+aJ.minor+"."+aJ.release);var aH=window.opentokdebug.getLogs();aB(aG,"jsLogs",aH);var aE=false;var aZ=0;for(var aW in TB.sessions){var aF=TB.sessions[aW];if(!aF.hasOwnProperty("sessionId")){continue}if(!aE){aB(aG,"apiKey",aF.apiKey);aE=true}var aM=0;aB(aG,"session_"+ ++aZ,aF.sessionId);var aP="controller_"+aF.sessionId;var a1=ah(aP);if(a1){aB(aG,"widget_"+aF.sessionId+"_"+ ++aM,a1)}if(aF.hasOwnProperty("subscribers")){for(var aO in aF.subscribers){if(aF.subscribers[aO].hasOwnProperty("id")){var aY=ah(aF.subscribers[aO].id);aB(aG,"widget_"+aF.sessionId+"_"+ ++aM,aY)}}}if(aF.hasOwnProperty("publishers")){var aI=0;for(var aS in aF.publishers){if(aF.publishers[aS].hasOwnProperty("id")){var aU=ah(aF.publishers[aS].id);aB(aG,"widget_"+aF.sessionId+"_"+ ++aM,aU)}}}}if(!aK){if(!aV){var aN=document.createElement("textarea");aN.setAttribute("name","description");aN.setAttribute("rows",8);aN.setAttribute("cols",40);aN.style.height="110px";aN.style.width="300px";aN.style.display="block";aN.style.visibility="visible";aG.appendChild(aN);var a0=document.createElement("input");a0.setAttribute("type","submit");a0.setAttribute("value","Report Issue");a0.style.display="inline";a0.style.visibility="visible";aG.appendChild(a0);var aR=document.createElement("input");aR.setAttribute("type","button");aR.setAttribute("value","Cancel");aR.style.display="inline";aR.style.visibility="visible";aG.appendChild(aR);var aT=390;var aQ=242;var aL=document.createElement("div");aL.setAttribute("id","opentokReportIssue");aL.style.position="absolute";aL.style.top="25%";aL.style.left="50%";aL.style.width=aT+"px";aL.style.height=aQ+"px";aL.style.marginLeft=(0-aT/2)+"px";aL.style.marginTop=(0-aQ/4)+"px";aL.style.paddingLeft="32px";aL.style.paddingRight="15px";aL.style.paddingTop="15px";aL.style.display="block";aL.style.visibility="visible";aL.style.lineHeight="15px";aL.style.zIndex=Q()+1;aL.innerHTML='<span style="color:#4c4c4c;font-size:18px;display:inline;visibility:visible;">We\'re sorry to hear that something went wrong.</span><br/><br/>Please help us to debug your issue by providing a description of what happened.';aL.style.backgroundColor="#F7F7F7";aL.style.border="1px solid #CCC";aL.style.fontWeight="normal";aL.style.fontFamily="'Lucida Grande', 'Trebuchet MS', sans-serif";aL.style.color="#4c4c4c";aL.style.fontSize="13px";aL.appendChild(aG);document.body.appendChild(aL);y=true;closeForm=function(){document.body.removeChild(aL);y=false};aR.onclick=closeForm;aG.onsubmit=function(){window.open("#","formresult","scrollbars=no,menubar=no,height=200,width=400,resizable=yes,toolbar=no,status=no");setTimeout(function(){closeForm()},1000)}}else{aB(aG,"description",aV);document.body.appendChild(aG);L("formresult",aG,true)}}if(aK){aG.onsubmit=function(){window.open("#","formresult","scrollbars=no,menubar=no,height=200,width=400,resizable=yes,toolbar=no,status=no");setTimeout(function(){closeForm()},1000)};aB(aG,"showReport",true);document.body.appendChild(aG);aG.submit()}}}}();
/*
 *	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
 * 	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
 * 	
 * 	Permission is hereby granted, free of charge, to any person obtaining a copy
 * 	of this software and associated documentation files (the "Software"), to deal
 * 	in the Software without restriction, including without limitation the rights
 * 	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * 	copies of the Software, and to permit persons to whom the Software is
 * 	furnished to do so, subject to the following conditions:
 * 	
 * 	The above copyright notice and this permission notice shall be included in
 * 	all copies or substantial portions of the Software
 */
var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var q={};if(g&&typeof g===aD){for(var o in g){q[o]=g[o]}}q.data=k;q.width=h;q.height=f;var n={};if(i&&typeof i===aD){for(var p in i){n[p]=i[p]}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]}else{n.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(q,n,e);if(q.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){q.data=a;ae(q,n,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();
/*
 * JavaScript Debug - v0.4 - 6/22/2010
 * http://benalman.com/projects/javascript-debug-console-log/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 */
window.opentokdebug=(function(){var j=this,b=Array.prototype.slice,d=j.console,i={},f,g,n=0,c=["error","warn","info","debug","log"],m="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),k=m.length,a=[];while(--k>=0){(function(o){i[o]=function(){n!==0&&d&&d[o]&&d[o].apply(d,arguments)}})(m[k])}k=c.length;while(--k>=0){(function(o,p){i[p]=function(){var r=b.call(arguments),q=[p,h()].concat(r);a.push(q);if(!d||!l(o)){return}e(q);(d.firebug||j.Firebug)?d[p].apply(d,r):d[p]?d[p](r):d.log(r)}})(k,c[k])}function e(o){if(f&&(g||!d||!d.log)){f.apply(j,o)}}function h(){var o=new Date();return o.toLocaleTimeString()+o.getMilliseconds()}i.setLevel=function(o){n=typeof o==="number"?o:9};function l(o){return n>0?n>o:c.length+n<=o}i.setCallback=function(){var p=b.call(arguments),o=a.length,q=o;f=p.shift()||null;g=typeof p[0]==="boolean"?p.shift():false;q-=typeof p[0]==="number"?p.shift():o;while(q<o){e(a[q++])}};i.getLogs=function(){return a.join("\n")};return i})();if(!Object.keys){Object.keys=function(c){if(c!==Object(c)){throw new TypeError("Object.keys called on non-object")}var a=[],b;for(b in c){if(Object.prototype.hasOwnProperty.call(c,b)){a.push(b)}}return a}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c){if(this===void 0||this===null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var e=0;if(arguments.length>0){e=Number(arguments[1]);if(e!==e){e=0}else{if(e!==0&&e!==Infinity&&e!==-Infinity){e=(e>0||-1)*Math.floor(Math.abs(e))}}}if(e>=a){return -1}var b=e>=0?e:Math.max(a-Math.abs(e),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}};